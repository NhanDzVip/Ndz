getgenv().HopServer = function()
    local HttpService = game:GetService("HttpService")
    local TeleportService = game:GetService("TeleportService")
    local PlaceID = game.PlaceId
    local minPlayers = math.huge
    local bestServer = nil

    local success, result = pcall(function()
        return HttpService:JSONDecode(game:HttpGet("https://games.roblox.com/v1/games/" .. PlaceID .. "/servers/Public?sortOrder=Asc&limit=100"))
    end)

    if success and result and result.data then
        for _, v in pairs(result.data) do
            if v.playing < v.maxPlayers and v.id ~= game.JobId and v.playing < minPlayers then
                minPlayers = v.playing
                bestServer = v.id
            end
        end

        if bestServer then
            print("ðŸ”„ Äang hop vÃ o server Ã­t ngÆ°á»i nháº¥t (" .. minPlayers .. " ngÆ°á»i chÆ¡i)...")
            TeleportService:TeleportToPlaceInstance(PlaceID, bestServer, game.Players.LocalPlayer)
        else
            print("âš ï¸ KhÃ´ng tÃ¬m tháº¥y server phÃ¹ há»£p, thá»­ láº¡i ngay!")
        end
    else
        print("âŒ Lá»—i láº¥y danh sÃ¡ch server, thá»­ láº¡i ngay!")
    end
end

function CheckLegendaryHakiDealer()
    for _, npc in pairs(game.Workspace:GetChildren()) do
        if npc.Name == "Legendary Haki Dealer" then
            return npc
        end
    end
    return nil
end

function TeleportToNPC(npc)
    local player = game.Players.LocalPlayer
    local character = player.Character
    if character and npc then
        local hrp = character:FindFirstChild("HumanoidRootPart")
        if hrp then
            hrp.CFrame = npc.CFrame + Vector3.new(0, 5, 0) -- Dá»‹ch lÃªn trÃªn NPC má»™t chÃºt
        end
    end
end

spawn(function()
    while task.wait(1) do -- Kiá»ƒm tra nhanh hÆ¡n
        pcall(function()
            local npc = CheckLegendaryHakiDealer()

            if npc then
                print("ðŸŸ¢ ÄÃ£ tÃ¬m tháº¥y Legendary Haki Dealer!")
                TeleportToNPC(npc) -- Náº¿u tÃ¬m tháº¥y, teleport Ä‘áº¿n NPC
            else
                print("ðŸ”„ KhÃ´ng tháº¥y NPC, hop vÃ o server Ã­t ngÆ°á»i nháº¥t!")
                HopServer() -- Náº¿u khÃ´ng tháº¥y, hop server Ã­t ngÆ°á»i nháº¥t
            end
        end)
    end
end)
